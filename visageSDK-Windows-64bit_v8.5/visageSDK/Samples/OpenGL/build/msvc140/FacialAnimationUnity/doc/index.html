<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FacialAnimationUnity: visage|SDK FacialAnimationUnity example project</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FacialAnimationUnity
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">visage|SDK FacialAnimationUnity example project </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p> 
<table border="0">
<tr>
<td width="32"><a href="../../../../../../bin64/FacialAnimationUnityDemo.exe"><img src="../../../../../../doc/OpenGL/images/run_sample.png" border=0 title="Run Sample (this may not work in all browsers, in such case please run FacialAnimationUnityDemo.exe from the visageSDK\bin64 folder.)"></a></td>
<td width="32"><a href="../../../../../../bin64"><img src="../../../../../../doc/OpenGL/images/open_bin_folder.png" border=0 title="Open Binary Folder (visageSDK\bin64)"></a></td>
<td width="32"><a href="../../../../data/FacialAnimationUnity"><img src="../../../../../../doc/OpenGL/images/open_data_folder.png" border=0 title="Open Data Folder"></a></td>
</tr>
</table>
</p>
<p>The FacialAnimationUnityDemo sample project demonstrates the integration of visage|SDK with Unity game engine and is aimed at developers starting to use face tracking functionality of visage|SDK to drive facial animation using blendshapes and bones in the Unity game engine.</p>
<h1><a class="anchor" id="using"></a>
Using the sample application</h1>
<p><br />
<br />
 In order to try the sample application, you need to have a valid license key. More information on how to obtain license key and include it in the application can be found in <a href="../../../../../../doc/OpenGL/licensing.html"><em>Licensing</em></a> section of the documentation. <br />
<br />
</p>
<p>To start the application, double-click on FacialAnimationUnity.exe located in <em>visageSDK/bin64 </em>folder.</p>
<p>As soon as the application starts, tracking will begin. When a face is found in the camera frame, the character will start moving - mimicking the user's facial expressions. Try opening your mouth, smiling or moving your eyebrows. Available buttons are: Play/Pause in the lower left corner, Switch camera in the lower right corner and Normal/Mask in the upper right corner of the screen. If no license key is present the tracking will not work - please refer to the <a href="../../../../../../doc/OpenGL/licensing.html">licensing section</a> for details.</p>
<h1><a class="anchor" id="building"></a>
Building the project</h1>
<p>The files related to FacialAnimationUnity sample project are located in the Samples/OpenGL/data/FacialAnimationUnity subfolder of the visage|SDK folder.</p>
<p>The application was built and tested with version 2018.3.0f2.</p>
<p>To build FacialAnimationUnity sample two steps are involved: creating the Unity project from the provided Unity package and building the application.</p>
<h2><a class="anchor" id="creatingUnity"></a>
Creating the Unity project from Unity package</h2>
<p>To create the Unity project from provided Unity package follow these steps:</p><ol type="1">
<li>Create a new Unity project</li>
<li>Import FacialAnimationUnity.unitypackage (provided in Samples/OpenGL/data/FacialAnimationUnity folder) by selecting Assets-&gt;Import Package-&gt;Custom Package... item from the menu. That way all the assets that are used by the example project will be imported into the new project.</li>
<li>Select and open the "Visage Tracker/Jones/jones" scene.</li>
</ol>
<h2><a class="anchor" id="generateApp"></a>
Building the application</h2>
<p>To build the application follow these steps:</p><ol type="1">
<li>Build the application by selecting File-&gt;Build settings... and under Platform choose PC and Mac Standalone and set Windows as target platform. Check if the correct Architecture is set: <em>x86_64</em>.</li>
<li>Press the Build button to generate the project, a dialog window will appear. In this window, locate and set destination folder to <em>visageSDK/bin64</em>.</li>
</ol>
<h2><a class="anchor" id="editor"></a>
Running the project through Unity editor</h2>
<ol type="1">
<li>Follow steps on creating a Unity project.</li>
<li>Application is dependent on libraries located in <em>visageSDK/bin64 </em>folder. Copy libraries to the Unity project root folder (e.g. <em>C:/MyUnityProjects/FacialAnimationUnity</em>):<ul>
<li>opencv_core2411.dll</li>
<li>opencv_imgproc2411.dll</li>
<li>VisageTrackerUnityPlugin64.dll<ul>
<li>libVisageVision64.dll<ul>
<li>libopenblas.dll</li>
<li>libgfortran-3.dll</li>
<li>libquadmath-0.dll</li>
<li>libgcc_s_seh-1.dll<ul>
<li>libVisageAnalyser64.dll</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Create a <a href="https://docs.unity3d.com/Manual/StreamingAssets.html" target="New">StreamingAssets/Visage Tracker</a> folder in your Unity project Assets folder</li>
<li>Copy following files and folders from the <em>visageSDK/Samples/data</em> folder to the <em>StreamingAssets/Visage Tracker</em> folder:<ul>
<li>bdtsdata folder</li>
<li>candide3.wfm</li>
<li>candide3.fdp</li>
<li>jk_300.wfm</li>
<li>jk_300.fdp</li>
<li>configuration files (Head Tracker.cfg, Facial Features Tracker - High.cfg and Facial Features Tracker - Low.cfg)</li>
</ul>
</li>
</ol>
<p>NOTE: In case you have license key file, add it also to the <em>StreamingAssets/Visage Tracker</em> folder. Additionally, set the <em>licenseString</em> member of the LicenseString class (script LicenseString.cs) so it contains name of the license key file.</p>
<h1><a class="anchor" id="implementation"></a>
Implementation overview</h1>
<p>The project consists of a main scene with the Unity’s GameObjects that provide different functionalities. A GameObject is the main building block of a scene in Unity. It consists of different Components and can parent other GameObjects. Manipulation of GameObjects is done with Scripts. It is recommended for developers to get familiar with Unity basics before continuing. The integration with visage|SDK is done through a plugin (VisageTrackerUnityPlugin) that wraps native code calls to visage|SDK and provides functions that can be called from Unity scripts. The source code for the plugin can be found in the VisageTrackerUnityPlugin project in the samples folder.</p>
<h2><a class="anchor" id="trackerGO"></a>
Tracker GameObject</h2>
<p>The core of the example is the Visage Tracker GameObject. It handles communication with the tracker (starts it and gets results from it). The behaviour of the script can be modified by changing its properties and the script code. Other properties can be added as well. The existing Visage Tracker script properties of interest are as follows:<br />
 • Config File Standalone: filename of the tracker configuration file (see the <a href="../../../../../../doc/OpenGL/VisageTracker Configuration Manual.pdf">VisageTracker Configuration manual</a> for information on modifying the tracker configuration) that will be used by the tracker for standalone platforms<br />
 • Config File Editor: filename of the tracker configuration file (see the <a href="../../../../../../doc/OpenGL/VisageTracker Configuration Manual.pdf">VisageTracker Configuration manual</a> for information on modifying the tracker configuration) that will be used by the tracker in the editor<br />
 • BindingConfigurations: list of binding configurations (see the Binding Configuration section on this page) used in the scene<br />
</p>
<h2><a class="anchor" id="cameras"></a>
Cameras</h2>
<p>There are two cameras in the scene, one for displaying the character (Main Camera) and other for the background (Background Camera). The main camera "Field of View" is automatically set according to the Visage Tracker focus (camera_focus parameter in configuration file).</p>
<h2><a class="anchor" id="jonesObject"></a>
Jones object</h2>
<p>Jones is the character with defined blendshape animations which are controlled using the a binding configuration and bones which are controlled using the <em>Visage Tracker/Jones/Scripts/Movement.cs</em> script. The visage|SDK provides relevant information about facial expressions through action units. Their values are then mapped to specific blendshapes using binding configurations in the <em>VisageTracker.cs</em> script. For more information on creating characters with such blendshapes, consult the <a href="../../../../../../doc/OpenGL/modeling_guide.pdf" target="_blank">Modeling Guide</a>.</p>
<h2><a class="anchor" id="bindingConfiguration"></a>
Binding configuration</h2>
<p>Binding configurations map action unit values to specific blendshapes and animate them. A reference binding configuration used to animate Jones is located in <em>Visage Tracker/Jones/jones.bind.txt</em>. <br />
 <em>ActionUnitBinding.cs</em> components are created based on the <em>VisageTracker.cs</em> Binding Configuration list in the current scene at runtime. They receive action unit data from the Visage Tracker component and map them to [0,1] values based on the info given in the binding configuration. You can omit the binding configuration and create the <em>ActionUnitBinding.cs</em> components manually for more control.</p>
<h2><a class="anchor" id="plugin"></a>
VisageTrackerUnityPlugin</h2>
<p>The integration of visage|SDK face tracking with Unity is done through a plugin that wraps native code calls and provides functions that can be called from Unity scripts. For more information about the plugin including it's source code, see the VisageTrackerUnityPlugin project and its documentation. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Mar 14 2019 14:47:50 for FacialAnimationUnity by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
